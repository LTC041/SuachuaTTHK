<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Xuất Hồ Sơ</title>
    <link rel="stylesheet" href="./A4.css" />
  </head>
  <body>
    <div class="WordSection3">
      <div class="header-page-buy">
        <div class="left-header-page-buy flex-column">
          <p class="text-title-12">TRUNG TÂM THÔNG BÁO TIN TỨC HÀNG KHÔNG</p>
          <p
            class="text-title-12 department"
            style="border-bottom: 0.5px solid #000; margin-bottom: 10px"
          ></p>
        </div>

        <div class="right-header-page-buy flex-column">
          <p class="text-title-12">CỘNG HOÀ XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
          <p
            class="text-title-13"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            Độc lập – Tự do – Hạnh phúc
          </p>
        </div>
      </div>
      <div style="margin-top: 60px" class="main-page">
        <p class="text-title-14 title-main-page">
          PHIẾU ĐỀ NGHỊ CUNG CẤP HÀNG HOÁ
        </p>
        <p class="text-title-14" style="text-align: center">
          Kính gửi: Giám đốc
        </p>

        <div style="text-indent: 4px">
          <div
            class="flex-beetwen"
            style="margin-top: 40px; margin-bottom: 4px"
          >
            <p class="text-title-14">
              Tên tôi là: <span class="requester"></span>
            </p>
            <span>Chức vụ: Nhân viên</span>
          </div>

          <p style="margin-bottom: 4px !important">
            Bộ phận công tác: <span class="department"></span>
          </p>
          <div style="font-size: 14pt; line-height: 1.5">
            <div
              style="
                display: grid;
                grid-template-columns: auto 1fr;
                column-gap: 6px;
              "
            >
              <div style="white-space: nowrap">Lý do:</div>
              <div
                contenteditable="true"
                style="
                  white-space: pre-wrap;
                  word-break: break-word;
                  outline: none;
                "
              ></div>
            </div>
          </div>
          <p>Đề nghị Giám đốc xem xét và duyệt cấp:</p>
          <div style="margin: 12px 0">
            <table id="table1">
              <tr>
                <th rowspan="2">STT</th>
                <th style="width: 199px" rowspan="2">
                  Tên hàng hoá (bao gồm nhãn hiệu, quy cách)
                </th>
                <th rowspan="2">Mã số</th>
                <th rowspan="2">ĐVT</th>
                <th colspan="2">Số lượng</th>
                <th rowspan="2">Ghi chú</th>
              </tr>
              <tr>
                <th style="white-space: nowrap">Yêu cầu</th>
                <th>Duyệt</th>
              </tr>
              <tr>
                <td contenteditable="true" style="word-break: break-word">1</td>
                <td
                  contenteditable="true"
                  style="word-break: break-word"
                  class="break-after-print"
                ></td>

                <td></td>
                <td contenteditable="true"></td>
                <td><input id="input1" type="text" value="01" /></td>
                <td></td>
                <td></td>
              </tr>
            </table>
            <button onclick="addRow('table1')">Thêm dòng cho bảng 1</button>
            <button onclick="deleteRow('table1')">Xoá dòng bảng 1</button>
            <p
              style="
                margin-top: 8px;
                display: flex;
                justify-content: end;
                font-style: italic;
              "
            >
              Hà Nội, ngày &nbsp &nbsp &nbsp tháng &nbsp &nbsp &nbsp năm 2025
            </p>
          </div>
        </div>
      </div>

      <div
        style="margin-top: 20px; display: flex; justify-content: space-between"
        class="footer-page-buy"
      >
        <div class="sign-boss">
          <p>Giám đốc</p>
        </div>
        <div class="flex-column plan-office">
          <p style="height: 140px">Phòng kế hoạch</p>
          <p style="color: white">Nguyễn Thị Thu</p>
        </div>
        <div style="justify-items: center" class="flex-column none-sign">
          <p
            style="text-transform: uppercase; height: 140px"
            class="department-short break-after-trung-tam"
          ></p>
          <p class="officer"></p>
        </div>
      </div>
    </div>
    <div class="WordSection2">
      <div class="header-page">
        <div class="left-header-page flex-column">
          <p class="text-title-12">TRUNG TÂM THÔNG BÁO TIN TỨC HÀNG KHÔNG</p>
          <p
            class="text-title-12"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            Phòng Kế hoạch
          </p>
        </div>

        <div class="right-header-page flex-column">
          <p class="text-title-12">CỘNG HOÀ XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
          <p
            class="text-title-13"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            Độc lập – Tự do – Hạnh phúc
          </p>
        </div>
      </div>
      <div class="main-page">
        <p class="text-title-14 title-main-page">
          BIÊN BẢN KIỂM TRA KỸ THUẬT VẬT TƯ <br />
          THIẾT BỊ TRƯỚC KHI SỬA CHỮA
        </p>
        <p class="text-title-14" style="text-align: left; margin: 20px 0">
          - Căn cứ phiếu báo hỏng của <span class="department"></span>.
        </p>
        <p style="letter-spacing: -0.5px">
          Hôm nay, ngày......tháng......năm 2025 tại Trung tâm Thông báo tin tức
          hàng không.
        </p>
        <p style="font-weight: bold; margin-top: 16px; margin-bottom: 4px">
          Đại diện các bên gồm:
        </p>

        <p>1. Đại diện đơn vị sử dụng hoặc kho:</p>
        <div class="flex-beetwen">
          <p style="margin: 2px 0">
            - Ông (bà): <span class="representativeStaff"></span>
          </p>
          <p>Chức vụ : Nhân viên</p>
        </div>
        <p>2. Đại diện đơn vị chức năng:</p>
        <div class="flex-beetwen">
          <p style="margin: 2px 0">- Ông (bà): Lê Tuấn Cường</p>
          <p style="margin-right: 24px">Chức vụ : NVKH</p>
        </div>
        <div class="flex-beetwen">
          <p style="margin: 2px 0">- Ông (bà): Vũ Hải Hà</p>
          <p style="margin-right: 24px">Chức vụ : NVKT</p>
        </div>
        <p style="font-weight: bold; margin-top: 8px; margin-bottom: 4px">
          Đại diện các bên đã tiến hành kiểm tra, đánh giá các nội dung sau:
        </p>

        <ul>
          <li>
            <p>1. Thông tin về tài sản:</p>
          </li>
          <li style="display: flex">
            <div style="font-size: 14pt; line-height: 1.5">
              <div
                style="
                  display: grid;
                  grid-template-columns: auto 1fr;
                  column-gap: 6px;
                "
              >
                <div style="white-space: nowrap">- Tên vật tư thiết bị:</div>
                <div
                  contenteditable="true"
                  style="
                    white-space: pre-wrap;
                    word-break: break-word;
                    outline: none;
                  "
                ></div>
              </div>
              <div
                style="
                  display: grid;
                  grid-template-columns: auto 1fr;
                  column-gap: 6px;
                "
              >
                <div style="white-space: nowrap">- Số S/N (nếu có):</div>
                <div
                  contenteditable="true"
                  style="
                    white-space: pre-wrap;
                    word-break: break-word;
                    outline: none;
                  "
                ></div>
              </div>
            </div>
          </li>
          <li>
            <p>2. Địa điểm lắp đặt: <span class="department"></span></p>
          </li>
          <li>
            <p>
              3. Đơn vị sử dụng/quản lý thiết bị:
              <span class="department"></span>
            </p>
          </li>
          <li>
            <div style="font-size: 14pt; line-height: 1.3">
              <p class="fix-same-word" contenteditable="true">
                4. Tình trạng hiện tại của thiết bị:
              </p>
            </div>
          </li>
          <li>
            <div style="font-size: 14pt; line-height: 1.3">
              <p contenteditable="true" class="fix-same-word">
                5. Phương án thực hiện sửa chữa:
              </p>
            </div>
          </li>
          <li>
            <p>6. Kết luận: Đồng ý phương án sử chữa.</p>
          </li>
        </ul>

        <p style="display: none" class="text-title-14 title-main-page">
          BẢNG YÊU CẦU VẬT TƯ
        </p>
        <p style="margin-bottom: 8px; display: none">
          Đề nghị cung cấp các vật tư, linh kiện sau để phục vụ sửa chữa:
        </p>
        <div style="text-indent: 12px; display: none">
          <table id="table2">
            <tr>
              <th>STT</th>
              <th style="width: 140px">Đơn vị sử dụng</th>
              <th style="width: 220px">Tên vật tư, linh kiện</th>
              <th>Quy cách chủng loại, yêu cầu kỹ thuật</th>
              <th>Số lượng</th>
            </tr>
            <tr style="text-align: center">
              <td>1</td>
              <td style="text-wrap: balance" class="department-short"></td>
              <td class="break-after-print">
                Hộp mực <span class="printerName"></span>
              </td>
              <td></td>
              <td id="quantity">
                <input id="input1" type="text" value="01" />
              </td>
              <!-- Số lượng có id để cập nhật -->
            </tr>
          </table>
          <button onclick="addRow('table2')">Thêm dòng cho bảng 1</button>
          <button onclick="deleteRow('table2')">Xoá dòng bảng 1</button>
        </div>
      </div>
      <div class="footer-page flex-beetwen">
        <div style="justify-items: center" class="left-ft-page flex-column">
          <p class="break-after-trung-tam">PHÒNG KẾ HOẠCH</p>
          <p style="color: white">Nguyễn Thị Thu</p>
        </div>
        <div style="justify-items: center" class="left-ft-page flex-column">
          <p class="break-after-trung-tam">PHÒNG BĐKT</p>
          <p>Nguyễn Văn Toàn</p>
        </div>
        <div class="right-ft-page flex-column">
          <p>Đơn vị sử dụng</p>
          <p class="representative"></p>
        </div>
      </div>
    </div>
    <div class="WordSection1">
      <div class="header-page">
        <div class="left-header-page flex-column">
          <p class="text-title-12">TRUNG TÂM THÔNG BÁO TIN TỨC HÀNG KHÔNG</p>
          <p
            class="text-title-12 department"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          ></p>
        </div>

        <div class="right-header-page flex-column">
          <p class="text-title-12">CỘNG HOÀ XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
          <p
            class="text-title-13"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            Độc lập – Tự do – Hạnh phúc
          </p>
        </div>
      </div>
      <div class="main-page">
        <p class="text-title-14 title-main-page">
          PHIẾU BÁO HỎNG TÀI SẢN, VẬT TƯ, TRANG THIẾT BỊ
        </p>
        <p class="text-title-14" style="text-align: center">
          Kính gửi: Phòng Kế hoạch
        </p>

        <div style="text-indent: 12px">
          <div
            class="flex-beetwen"
            style="margin-top: 40px; margin-bottom: 4px"
          >
            <p class="text-title-14">
              Tên tôi là: <span class="requester"></span>
            </p>
            <span>Chức vụ: Nhân viên</span>
          </div>

          <p style="margin-bottom: 4px !important">
            Bộ phận công tác: <span class="department"></span>
          </p>
          <p>Xin báo cáo tài sản, trang thiết bị, vật tư bị hỏng như sau:</p>
          <div style="margin: 12px 0">
            <table id="table3">
              <tr>
                <th>STT</th>
                <th style="width: 200px">
                  Tên tài sản, vật tư, trang thiết bị báo hỏng
                </th>
                <th>Số thẻ</th>
                <th>ĐVT</th>
                <th>Số lượng</th>
                <th>Tình trạng hỏng</th>
                <th>Ghi chú</th>
              </tr>
              <tr style="text-align: center">
                <td>1</td>
                <td contenteditable="true" style="word-break: break-word"></td>
                <td contenteditable="true" style="word-break: break-word"></td>
                <td contenteditable="true" style="word-break: break-word"></td>
                <td
                  contenteditable="true"
                  style="word-break: break-word"
                  id="quantity"
                ></td>
                <!-- Số lượng có id để cập nhật -->
                <td>Hỏng không sử dụng được</td>
                <td></td>
              </tr>
            </table>
            <button onclick="addRow('table3')">Thêm dòng cho bảng 1</button>
            <button onclick="deleteRow('table3')">Xoá dòng bảng 1</button>
            <p
              style="
                margin-top: 8px;
                display: flex;
                justify-content: end;
                font-style: italic;
              "
            >
              Hà Nội, ngày &nbsp &nbsp &nbsp tháng &nbsp &nbsp &nbsp năm 2025
            </p>
          </div>
        </div>
      </div>

      <div class="footer-page flex-around">
        <div style="justify-items: center" class="left-ft-page flex-column">
          <p class="department-short break-after-trung-tam"></p>
          <p class="officer"></p>
        </div>
        <div class="right-ft-page flex-column">
          <p>Người đề nghị</p>
          <p class="requester"></p>
        </div>
      </div>
    </div>
    <div class="WordSection4">
      <div class="header-page">
        <div class="left-header-page flex-column">
          <p class="text-title-12">TRUNG TÂM THÔNG BÁO TIN TỨC HÀNG KHÔNG</p>
          <p
            class="text-title-12"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            PHÒNG KẾ HOẠCH
          </p>
        </div>

        <div class="right-header-page flex-column">
          <p class="text-title-12">CỘNG HOÀ XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
          <p
            class="text-title-13"
            style="border-bottom: 1px solid #000; margin-bottom: 10px"
          >
            Độc lập – Tự do – Hạnh phúc
          </p>
        </div>
      </div>
      <div class="main-page">
        <p class="text-title-14 title-main-page">
          BIÊN BẢN THU HỒI TÀI SẢN, VẬT TƯ CŨ ĐÃ QUA SỬ DỤNG
        </p>
        <p class="text-title-14" style="margin-top: 30px">
          Căn cứ vào biên bản xác định tình trạng kỹ thuật vật tư, thiết bị ngày
          &nbsp &nbsp &nbsp tháng năm 2025
        </p>
        <p class="text-title-14" style="margin-top: 6pt">
          Hôm nay, ngày <span class="dayW4"></span> tháng
          <span class="monthW4"></span> năm 2025 tại TTTBTTHK
        </p>
        <p class="text-title-14" style="margin-top: 6pt">Chúng tôi gồm:</p>
        <p class="text-title-14" style="margin-top: 6pt">
          1. Bên giao: <span class="department"></span>
        </p>
        <div class="flex-beetwen ben-giao-requester">
          <p class="text-title-14" style="margin-top: 6pt">
            Ông (Bà): <span class="requester"></span>
          </p>
          <span>Chức vụ: Nhân viên</span>
        </div>
        <div class="flex-beetwen ben-giao-ngocnga">
          <p class="text-title-14" style="margin-top: 6pt">
            Ông (Bà): Đặng Thị Ngọc Ngà</span>
          </p>
          <span>Chức vụ: Nhân viên</span>
        </div>
        <p class="text-title-14" style="margin-top: 6pt">
          2. Bên nhận: <span> Kho trung tâm</span>
        </p>
        <div class="flex-beetwen">
          <p class="text-title-14" style="margin-top: 6pt">
            Ông (Bà): Đào Thị Thanh
          </p>
          <span>Chức vụ: Nhân viên</span>
        </div>
        <p class="text-title-14" style="margin-top: 6pt">
          3. Đại diện cơ quan chức năng (Tài chính):
        </p>
        <div class="flex-beetwen">
          <p class="text-title-14" style="margin-top: 6pt">
            Ông (Bà): Dương Thị Lan Thu
          </p>
          <span>Chức vụ: Nhân viên</span>
        </div>
        <p class="text-title-14" style="margin-top: 6pt">
          Cùng nhau tiến hành thu hồi vật tư, tài sản đã qua sử dụng:
        </p>

        <div class="table-thu-hoi" style="margin-top: 6pt">
          <table id="table4">
            <thead>
              <tr>
                <th>STT</th>
                <th>Tên tài sản, công cụ</th>
                <th>Số thẻ</th>
                <th>ĐVT</th>
                <th>Số lượng</th>
                <th>Tháng năm đưa vào SD</th>
                <th>Nhãn hiệu, quy cách</th>
                <th>Nguồn gốc, xuất xứ</th>
                <th>Tình trạng hiện tại</th>
                <th>Ghi chú</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td
                  contenteditable="true"
                  style="word-break: break-word"
                  class="text-left"
                ></td>
                <td contenteditable="true" style="word-break: break-word"></td>
                <td contenteditable="true" style="word-break: break-word"></td>
                <td contenteditable="true" style="word-break: break-word">
                  <input type="text" id="input2" />
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td class="text-left">Hỏng, không sử dụng được</td>
                <td></td>
              </tr>
            </tbody>
          </table>
          <button onclick="addRow('table4')">Thêm dòng cho bảng 1</button>
          <button onclick="deleteRow('table4')">Xoá dòng bảng 1</button>
          <p style="margin-top: 6pt">
            Biên bản này được lập thành 03 bản có nội dung như nhau, mỗi bộ phận
            giữ 01 bản: Phòng Tài chính, bên giao, bên nhận.
          </p>
        </div>
      </div>

      <div class="footer-page flex-around">
        <div
          style="justify-items: center"
          class="left-ft-page flex-column ben-giao-requester"
        >
          <p>BÊN GIAO</p>
          <p class="requester"></p>
        </div>
        <div
          style="justify-items: center"
          class="left-ft-page flex-column ben-giao-ngocnga"
        >
          <p>BÊN GIAO</p>
          <p>Đặng Thị Ngọc Ngà</p>
        </div>
        <div style="justify-items: center" class="left-ft-page flex-column">
          <p>KẾ TOÁN TÀI SẢN</p>
          <p>Dương Thị Lan Thu</p>
        </div>
        <div class="right-ft-page flex-column">
          <p>BÊN NHẬN</p>
          <p>Đào Thị Thanh</p>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const data = localStorage.getItem("selectedPrinter");

        if (data) {
          const printerData = JSON.parse(data);

          // Hàm đặt nội dung cho tất cả các phần tử có cùng class
          const setText = (className, value) => {
            document.querySelectorAll(`.${className}`).forEach((element) => {
              element.textContent = value || "N/A";
            });
          };

          setText("department", printerData.department);
          setText("department-short", printerData.shortDepartment);
          setText("requester", printerData.requester);
          setText("officer", printerData.officer);
          setText("representative", printerData.representative);
          setText("representativeStaff", printerData.representativeStaff);
          setText("dayW4", printerData.daysW4);
          setText("monthW4", printerData.monthW4);
        } else {
          console.error("Không tìm thấy dữ liệu trong localStorage!");
        }
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document
          .querySelectorAll(".break-after-trung-tam")
          .forEach((element) => {
            element.innerHTML = element.innerHTML.replace(
              /(Trung tâm)\s/,
              "$1<br>"
            );
            element.style.textAlign = "center"; // Căn giữa nội dung
          });
      });
    </script>

    <script>
      function fixWidowText(selector) {
        document.querySelectorAll(selector).forEach((el) => {
          let words = el.innerHTML.trim().split(" ");
          if (words.length > 1) {
            words[words.length - 2] += "&nbsp;" + words.pop();
            el.innerHTML = words.join(" ");
          }
        });
      }

      // Chỉ áp dụng cho phần tên máy in, không làm mất các phần khác
      fixWidowText(".printerName");
    </script>

    <script>
      // Lấy các phần tử input
      const input1 = document.getElementById("input1");
      const input2 = document.getElementById("input2");

      // Gán giá trị ban đầu của input2 và input3 bằng giá trị của input1
      input2.value = input1.value;

      // Thêm sự kiện khi giá trị của input1 thay đổi
      input1.addEventListener("input", function () {
        input2.value = input1.value; // Cập nhật giá trị cho input2
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const section = document.querySelector(".WordSection3"); // Kiểm tra đúng section
        if (!section) return;

        const requesterElement = section.querySelector(".requester");
        if (!requesterElement) return;

        if (
          requesterElement.textContent.trim().toLowerCase() === "lê tuấn cường"
        ) {
          console.log("Người đề nghị là Lê Tuấn Cường! Ẩn phần chữ ký.");

          // Ẩn phần div có class "none-sign"
          const signatureDiv = section.querySelector(".none-sign");
          if (signatureDiv) {
            signatureDiv.style.display = "none";
            console.log("Đã ẩn phần none-sign");
          } else {
            console.log("Không tìm thấy phần none-sign để ẩn.");
          }

          // Tìm tất cả phần tử có class "footer-page-buy" và đổi justify-content
          const footerElements = section.querySelectorAll(".footer-page-buy");
          footerElements.forEach((element) => {
            if (
              window.getComputedStyle(element).justifyContent ===
              "space-between"
            ) {
              element.style.justifyContent = "space-around";
              console.log(
                "Đã thay justify-content: space-between thành space-around trong footer-page-buy."
              );
            }
          });
        }
      });
    </script>

    <!-- làm mất chữ Nguyễn Thị Thu -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".officer").forEach(function (el) {
          if (el.textContent.trim() === "Nguyễn Thị Thu") {
            el.style.color = "white";
          }
        });
      });
    </script>

    <!-- thêm dòng cho bảng -->
    <script>
      function addRow(tableId) {
        const table = document.getElementById(tableId);
        const tbody = table.querySelector("tbody");
        const lastRow = tbody.rows[tbody.rows.length - 1];
        const newRow = lastRow.cloneNode(true);

        // Reset nội dung
        for (let i = 1; i < newRow.cells.length; i++) {
          const cell = newRow.cells[i];
          const input = cell.querySelector("input");
          if (input) input.value = "";
          else cell.innerText = "";
        }

        tbody.appendChild(newRow);
      }

      function deleteRow(tableId) {
        const table = document.getElementById(tableId);
        const tbody = table.querySelector("tbody");
        if (tbody.rows.length > 1) {
          tbody.deleteRow(tbody.rows.length - 1);
        } else {
          alert("Phải có ít nhất một dòng!");
        }
      }
    </script>

    <!-- Chỉnh phần ký của biên bản thu hồi -->
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        const requesterElements = document.querySelectorAll('.requester');
    
        requesterElements.forEach(requesterEl => {
          const name = requesterEl.textContent.trim();
    
          // Tìm phần tử cha chứa .requester (có class ben-giao-requester)
          const benGiaoRequester = requesterEl.closest('.ben-giao-requester');
    
          // Tìm phần tử .ben-giao-ngocnga cùng cấp (nằm gần .ben-giao-requester trong DOM)
          let benGiaoNgocNga = null;
          let sibling = benGiaoRequester?.nextElementSibling;
    
          while (sibling) {
            if (sibling.classList.contains('ben-giao-ngocnga')) {
              benGiaoNgocNga = sibling;
              break;
            }
            sibling = sibling.nextElementSibling;
          }
    
          if (name === 'Dương Thị Lan Thu') {
            benGiaoRequester?.classList.add('hidden');
            benGiaoNgocNga?.classList.remove('hidden');
          } else {
            benGiaoRequester?.classList.remove('hidden');
            benGiaoNgocNga?.classList.add('hidden');
          }
        });
      });
    </script>
  </body>
</html>
